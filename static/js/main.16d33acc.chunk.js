(window.webpackJsonpposeidon=window.webpackJsonpposeidon||[]).push([[0],{12:function(e,t){e.exports="data:image/png;base64,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"},14:function(e,t,n){e.exports=n(22)},19:function(e,t,n){},21:function(e,t,n){},22:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(11),s=n.n(i),o=(n(19),n(1)),c=n.n(o),u=n(2),l=n(6),h=n(7),p=n(5),m=n(4),g=n(3),d=n(8),f=n(13),y={constants:{version:"001a",whence:"local",kTimerInterval:2500,kUsingTimer:!0,kInitialLanguage:"en",kInitialTurn:2020,kInitialPopulation:200,kInitialGameTypeName:"albacore",kSellingString:"selling",kFishingString:"fishing",kBetweenString:"between games",kInProgressString:"in progress",kWonString:"won",kLostString:"lost",kWaitingString:"waiting",kBaseURL:{local:"http://localhost:8888/plugins/poseidon/src/poseidon.php",xyz:"https://codap.xyz/projects/poseidon/src/poseidon.php"}},fishGameParameters:{albacore:{starter:!0,openingPopulation:400,carryingCapacity:3e3,winningPopulation:800,losingPopulation:100,openingBalance:5e3,openingTurn:2020,endingTurn:2060,defaultPrice:100,overhead:2e3,visibleProbability:.5,birthProbability:.1,catchProbability:1,binomialProbabilityModel:!1,boatCapacity:120,calculatePrice:function(e){return this.defaultPrice}},bonito:{starter:!1,openingPopulation:400,carryingCapacity:3e3,winningPopulation:800,losingPopulation:100,openingBalance:5e3,openingTurn:2020,endingTurn:2060,defaultPrice:100,overhead:2e3,visibleProbability:.5,birthProbability:.1,catchProbability:1,binomialProbabilityModel:!0,boatCapacity:120,calculatePrice:function(e){return this.defaultPrice}},cod:{starter:!1,openingPopulation:400,carryingCapacity:3e3,winningPopulation:1e3,losingPopulation:100,openingBalance:3e3,openingTurn:2020,endingTurn:2060,defaultPrice:100,overhead:2e3,visibleProbability:.5,birthProbability:.1,catchProbability:1,binomialProbabilityModel:!1,boatCapacity:120,priceMax:80,salesMax:200,calculatePrice:function(e){var t=this.priceMax*(1-e/this.salesMax);return t<0&&(t=0),t}},halibut:{starter:!1,openingPopulation:400,carryingCapacity:3e3,winningPopulation:1e3,losingPopulation:100,openingBalance:3e3,openingTurn:2020,endingTurn:2060,defaultPrice:100,overhead:2e3,visibleProbability:.5,birthProbability:.1,catchProbability:.6,binomialProbabilityModel:!0,boatCapacity:120,priceMax:80,salesMax:200,calculatePrice:function(e){var t=this.priceMax*(1-e/this.salesMax);return t<0&&(t=0),t}}}},b={sendRequest:function(){var e=Object(u.a)(c.a.mark(function e(t){var n,a,r,i,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a in"update"===t.action&&console.log("in sendRequest with "+JSON.stringify(t)),n=new FormData,t)t.hasOwnProperty(a)&&n.append(a,JSON.stringify(t[a]));return r=new Request(y.constants.kBaseURL[y.constants.whence],{method:"POST",body:n,header:new Headers}),e.next=6,fetch(r);case 6:if(!(i=e.sent).ok){e.next=20;break}return e.prev=8,e.next=11,i.json();case 11:return s=e.sent,e.abrupt("return",s);case 15:e.prev=15,e.t0=e.catch(8),console.log("fetch response decoding error : "+e.t0);case 18:e.next=21;break;case 20:alert("problem with database access -- icky respose");case 21:case"end":return e.stop()}},e,null,[[8,15]])}));return function(t){return e.apply(this,arguments)}}(),getGame:function(){var e=Object(u.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.gameCode){e.next=5;break}return n={whence:y.constants.whence,action:"get",resource:"game",values:{gameCode:t.gameCode}},e.next=4,this.sendRequest(n);case 4:return e.abrupt("return",e.sent);case 5:return console.log("No game code to get"),e.abrupt("return",!1);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getPlayers:function(){var e=Object(u.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.gameCode){e.next=5;break}return n={whence:y.constants.whence,action:"get",resource:"players",values:{gameCode:t.gameCode}},e.next=4,this.sendRequest(n);case 4:return e.abrupt("return",e.sent);case 5:return console.log("No game code to get, can't get players"),e.abrupt("return",!1);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getTurns:function(){var e=Object(u.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.gameCode||!t.turn){e.next=5;break}return n={whence:y.constants.whence,action:"get",resource:"turns",values:{gameCode:t.gameCode,gameTurn:t.turn}},e.next=4,this.sendRequest(n);case 4:return e.abrupt("return",e.sent);case 5:return console.log("No game code or year to get, can't get turns"),e.abrupt("return",!1);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),makeNewGame:function(){var e=Object(u.a)(c.a.mark(function e(t){var n,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=y.fishGameParameters[t],a={whence:y.constants.whence,action:"create",resource:"game",values:{onTurn:n.openingTurn,population:n.openingPopulation,configuration:t,gameState:y.constants.kInProgressString}},e.next=4,b.sendRequest(a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),setGame:function(){var e=Object(u.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={whence:y.constants.whence,action:"update",resource:"game",values:t},e.next=3,b.sendRequest(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),setTurns:function(){var e=Object(u.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={whence:y.constants.whence,action:"update",resource:"turns",values:t},e.next=3,b.sendRequest(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),setPlayers:function(){var e=Object(u.a)(c.a.mark(function e(t){var n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("setPlayers() with "+JSON.stringify(t)),n={whence:y.constants.whence,action:"update",resource:"players",values:t},e.next=4,b.sendRequest(n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},v=b,w={constructGameEndMessageFrom:function(e){var t="";if(e.end){var n=[];switch(e.time&&n.push("the game ends at year "+e.params.endingTurn),e.pop){case"high":n.push("the total fish population is now large enough to be sustainable");break;case"low":n.push("the total fish population is now too small to be sustainable")}e.broke.forEach(function(e){n.push(e+" has a negative bank balance")}),t=0===n.length?"...dang! We don't really know why!":n.join(", and ")+"."}return t}},k=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(p.a)(this,Object(m.a)(t).call(this))).theGame={gameCode:"",gameType:y.constants.kInitialGameTypeName,gameState:y.constants.kGameWaitingString},e.thePlayers=[],e.theTurns=[],e.gameParameters=y.fishGameParameters[e.theGame.gameType],Object(p.a)(e,Object(g.a)(e))}return Object(d.a)(t,e),Object(h.a)(t,[{key:"newGame",value:function(){var e=Object(u.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.gameParameters=y.fishGameParameters[t],e.next=3,v.makeNewGame(t);case 3:return this.theGame=e.sent,this.thePlayers=[],this.theTurns=[],e.abrupt("return",this.theGame);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"refreshAllData",value:function(){var e=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.getGame(this.theGame);case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0={};case 5:return this.theGame=e.t0,e.next=8,v.getPlayers(this.theGame);case 8:if(e.t1=e.sent,e.t1){e.next=11;break}e.t1=[];case 11:return this.thePlayers=e.t1,e.next=14,v.getTurns(this.theGame);case 14:if(e.t2=e.sent,e.t2){e.next=17;break}e.t2=[];case 17:this.theTurns=e.t2;case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sellFish",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.refreshAllData();case 2:return this.updateTurnsData(),this.updatePlayersData(),t=this.checkForEndGame(),e.next=7,v.setGame(this.theGame);case 7:return e.next=9,v.setTurns(this.theTurns);case 9:return e.next=11,v.setPlayers(this.thePlayers);case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"updateTurnsData",value:function(){var e=Number(this.theGame.population),t=this.theTurns.length,n=this.theTurns.reduce(function(e,t){return{caught:e.caught+Number(t.caught)}},{caught:0}),a=this.births();this.theGame.population=e+a-(t>0?n.caught/t:0),this.theGame.turn++;var r=this.gameParameters.calculatePrice(n.caught/t);console.log("... total caught: "+n.caught+", new population: "+this.theGame.population+" ... Unit price is "+r),this.theTurns.forEach(function(e){e.unitPrice=r,e.income=r*Number(e.caught),e.balanceAfter=Number(e.balanceBefore)+e.income-Number(e.expenses)})}},{key:"updatePlayersData",value:function(){var e=this;this.thePlayers.forEach(function(t){e.theTurns.forEach(function(e){e.playerName===t.playerName&&(t.balance=e.balanceAfter,t.onTurn=e.onTurn+1)})})}},{key:"births",value:function(){var e=this.theGame.population,t=this.gameParameters.birthProbability*(1-e/this.gameParameters.carryingCapacity),n=t*e;if(this.gameParameters.binomialProbabilityModel){n=0;for(var a=0;a<e;a++)Math.random()<t&&n++}return n}},{key:"checkForEndGame",value:function(){var e="",t="",n={end:!1,broke:[],time:!1,pop:"",params:this.gameParameters};return this.theGame.turn>=this.gameParameters.endingTurn&&(n.end=!0,n.time=!0,this.theGame.population>this.gameParameters.winningPopulation?(n.pop="high",t=y.constants.kWonString):(n.pop="low",t=y.constants.kLostString)),this.theTurns.forEach(function(e){e.balanceAfter<0&&(n.end=!0,n.broke.push(e.playerName),t=y.constants.kLostString)}),this.theGame.population<this.gameParameters.losingPopulation&&(n.end=!0,n.pop="low",t=y.constants.kLostString),n.end?(this.theGame.gameState=t,e=w.constructGameEndMessageFrom(n)):e="End of year "+this.theGame.turn,{reason:e,end:n.end}}},{key:"getCurrentSituation",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,n,a,r=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.refreshAllData();case 2:if(!this.theGame.gameCode){e.next=10;break}return t=[],n=[],this.thePlayers.forEach(function(e){var a=!1;r.theTurns.forEach(function(t){t.playerName===e.playerName&&(a=!0)}),n.push(e.playerName),a||t.push(e.playerName)}),a={OK:this.thePlayers.length===this.theTurns.length,missing:t,allPlayers:n},e.abrupt("return",a);case 10:return e.abrupt("return",{OK:!1,missing:[],allPlayers:[]});case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(Object(f.a)(Object)),P=function(e){function t(e){var n;return Object(l.a)(this,t),console.log("Constructing PoseidonHeader"),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).handleNewOrOldChange=function(e){n.setState({newOrOldGame:"new"===e.target.value})},n.handleGameTypeChange=function(e){n.setState({prospectiveGameType:e.target.value})},n.state={newOrOldGame:!0,prospectiveGameType:y.constants.kInitialGameTypeName,dirty:0},n.makeNewGame=n.makeNewGame.bind(Object(g.a)(n)),n}return Object(d.a)(t,e),Object(h.a)(t,[{key:"makeNewGame",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("gameTypesMenu").value,e.next=3,this.props.model.newGame(t);case 3:n=e.sent,console.log("... PoseidonHeader, new game "+n.gameCode),this.setDirty(),this.props.setDirty();case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setDirty",value:function(){var e=this.state.dirty+1;console.log("... setDirty() ... "+this.sitrep()),this.setState({dirty:e})}},{key:"sitrep",value:function(){console.log("... PoseidonHeader, sitrep "+this.state.dirty)}},{key:"render",value:function(){var e=this,t=this.props.model.theGame,n=r.a.createElement("div",null,"waiting"),a=Object.keys(y.fishGameParameters).map(function(e){return r.a.createElement("option",{key:e,value:e},e)}),i=this.state.newOrOldGame?r.a.createElement("select",{id:"gameTypesMenu",value:this.state.prospectiveGameType,onChange:function(t){return e.setState({prospectiveGameType:t.target.value})}},a):r.a.createElement("input",{type:"text"}),s=this.state.newOrOldGame?r.a.createElement("button",{onClick:this.makeNewGame},"new game (",this.state.prospectiveGameType,")"):r.a.createElement("button",null," join game "),o=r.a.createElement("div",null,r.a.createElement("label",null,r.a.createElement("input",{type:"radio",name:"newOrOldGame",value:"new",checked:this.state.newOrOldGame,onChange:this.handleNewOrOldChange})," new game")," |",r.a.createElement("label",null,r.a.createElement("input",{type:"radio",name:"newOrOldGame",value:"old",checked:!this.state.newOrOldGame,onChange:this.handleNewOrOldChange})," old game"));return n=t.gameState===y.constants.kInProgressString?r.a.createElement("div",null,"game: ",t.gameCode," | year: ",t.turn," | type: ",t.config):r.a.createElement("div",null,o,r.a.createElement("br",null),i,s),r.a.createElement("div",{id:"poseidonHeader"},n)}}]),t}(r.a.Component),O=(n(21),n(12)),x=n.n(O);function E(e){function t(){return(t=Object(u.a)(c.a.mark(function t(n){return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.doRefresh();case 1:case"end":return t.stop()}},t)}))).apply(this,arguments)}return r.a.createElement("div",null,r.a.createElement("input",{id:"refreshButton",type:"image",alt:"refresh",height:"14",width:"16",src:x.a,onClick:function(e){return t.apply(this,arguments)}}))}function C(e){var t=e.thePlayers.map(function(e){return r.a.createElement("tr",{key:e.playerName},r.a.createElement("td",null,e.playerName),r.a.createElement("td",null,e.onTurn),r.a.createElement("td",null,e.balance))}),n=e.thePlayers.length+" player(s)",a=r.a.createElement("tr",null,r.a.createElement("th",null,"name"),r.a.createElement("th",null,"turn"),r.a.createElement("th",null,"balance")),i=e.thePlayers.length>0?r.a.createElement("div",null,r.a.createElement("h2",null,n),r.a.createElement("div",null,r.a.createElement("table",{id:"playerTable"},r.a.createElement("thead",null,a),r.a.createElement("tbody",null,t)))):"No players";return r.a.createElement("div",null,i)}function T(e){if(e.OK)return r.a.createElement("div",null,r.a.createElement("button",{id:"sellFishButton",onClick:e.sellHandler},"sell fish"));if(e.missingNames.length>0){var t=e.missingNames.join(", ");return r.a.createElement("div",null,"Waiting for ",t)}return r.a.createElement("div",null,"No players")}var G=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(p.a)(this,Object(m.a)(t).call(this,e))).state={OKtoSell:!1,missing:[],dirty:0,now:new Date},console.log("Constructing Poseidon. State: "+JSON.stringify(n.state)),n.model=new k,n.setDirty=n.setDirty.bind(Object(g.a)(n)),n}return Object(d.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerID)}},{key:"poll",value:function(){var e=Object(u.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({now:new Date}),e.next=3,this.model.getCurrentSituation();case 3:t=e.sent,this.setState({OKtoSell:t.OK,missing:t.missing}),console.log("... poll() ... "+this.sitrep());case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setDirty",value:function(){var e=this.state.dirty+1;this.setState({dirty:e}),console.log("... setDirty() ... "+this.sitrep())}},{key:"sitrep",value:function(){var e=this.model.theGame;return"Poseidon sitrep: "+e.config+" game "+e.gameCode+" ("+e.gameState+") turn "+e.turn+" dirty = "+this.state.dirty}},{key:"sellFish",value:function(){var e=Object(u.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Selling fish!"),e.next=3,this.model.sellFish();case 3:this.setDirty(),console.log("Fish sold!");case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",{id:"poseidon"},r.a.createElement("h1",null,"Poseidon: God of the Sea"),r.a.createElement(P,{id:"poseidonHeader",model:this.model,setDirty:this.setDirty}),r.a.createElement(E,{doRefresh:this.poll.bind(this)}),r.a.createElement(T,{OK:this.state.OKtoSell,sellHandler:this.sellFish.bind(this),missingNames:this.state.missing}),r.a.createElement(C,{thePlayers:this.model.thePlayers}),r.a.createElement("div",null,this.state.now.toLocaleTimeString()))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[14,1,2]]]);
//# sourceMappingURL=main.16d33acc.chunk.js.map