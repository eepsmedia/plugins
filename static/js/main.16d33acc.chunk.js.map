{"version":3,"sources":["art/refresh.png","constants.js","poseidonPHPHelper.js","strings.js","Model.js","components/PoseidonHeader.js","Poseidon.js","serviceWorker.js","index.js"],"names":["module","exports","poseidon","constants","version","whence","kTimerInterval","kUsingTimer","kInitialLanguage","kInitialTurn","kInitialPopulation","kInitialGameTypeName","kSellingString","kFishingString","kBetweenString","kInProgressString","kWonString","kLostString","kWaitingString","kBaseURL","local","xyz","fishGameParameters","albacore","starter","openingPopulation","carryingCapacity","winningPopulation","losingPopulation","openingBalance","openingTurn","endingTurn","defaultPrice","overhead","visibleProbability","birthProbability","catchProbability","binomialProbabilityModel","boatCapacity","calculatePrice","n","this","bonito","cod","priceMax","salesMax","tPrice","halibut","phpConnect","sendRequest","iRequest","a","k","action","console","log","JSON","stringify","theBody","FormData","hasOwnProperty","append","theRequest","Request","method","body","header","Headers","fetch","theResponse","ok","json","out","alert","getGame","iGame","gameCode","tGameRequest","resource","values","getPlayers","tRequest","getTurns","turn","gameTurn","makeNewGame","iGameType","params","onTurn","population","configuration","gameState","setGame","tUpdateRequest","setTurns","iTurns","setPlayers","iPlayers","strings","constructGameEndMessageFrom","iReason","end","tMessageParts","time","push","pop","broke","forEach","p","length","join","Model","theGame","gameType","kGameWaitingString","thePlayers","theTurns","gameParameters","refreshAllData","updateTurnsData","updatePlayersData","endGameObject","checkForEndGame","tN0","Number","nPlayers","tTotalCaughtFish","reduce","v","caught","tBirths","births","tUnitPrice","t","unitPrice","income","balanceAfter","balanceBefore","expenses","playerName","balance","tPop","tAdjustedProbability","tOut","i","Math","random","tReasonText","tEnd","tReasonObject","reason","missingPlayers","allPlayers","innit","OK","missing","Object","PoseidonHeader","props","handleNewOrOldChange","e","setState","newOrOldGame","target","value","handleGameTypeChange","prospectiveGameType","state","dirty","bind","theChosenType","document","getElementById","model","newGame","setDirty","newDirty","sitrep","wholeThing","typesMenuGuts","keys","map","key","gameCodeOrTypeMenu","id","onChange","type","createOrJoinButton","onClick","radioButtons","name","checked","config","React","Component","RefreshButton","doRefresh","alt","height","width","src","refreshIcon","PlayerList","listGuts","headerText","tableHeader","SellButton","sellHandler","missingNames","missingPlayerList","Poseidon","OKtoSell","now","Date","clearInterval","timerID","getCurrentSituation","theSituationResponse","sellFish","poll","toLocaleTimeString","Boolean","window","location","hostname","match","ReactDOM","render","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.16d33acc.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,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\"","/*\n==========================================================================\n\n * Created by tim on 9/3/19.\n \n \n ==========================================================================\nconstants.js in poseidon\n\nAuthor:   Tim Erickson\n\nCopyright (c) 2018 by The Concord Consortium, Inc. All rights reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\nhttp://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n==========================================================================\n\n*/\n\n//  import model from \"./Model.js\";\n\nconst poseidon = {\n\n    constants: {\n        version: \"001a\",\n        whence : \"local\",\n\n        kTimerInterval: 2500,       //      milliseconds, ordinarily 1000\n        kUsingTimer: true,\n        kInitialLanguage: 'en',    //  can override with URL parameter *lang*, e.g., \"...index.html?lang=es\"\n\n        kInitialTurn: 2020,\n        kInitialPopulation: 200,\n        kInitialGameTypeName : \"albacore\",\n\n        //  player states\n        kSellingString: \"selling\",\n        kFishingString: \"fishing\",\n        kBetweenString: \"between games\",\n\n        //  game states\n        kInProgressString: \"in progress\",\n        kWonString: \"won\",\n        kLostString: \"lost\",\n        kWaitingString: \"waiting\",      //\n\n        kBaseURL: {\n            local: \"http://localhost:8888/plugins/poseidon/src/poseidon.php\",\n            xyz: \"https://codap.xyz/projects/poseidon/src/poseidon.php\",\n        },\n    },\n\n    /**\n     * This object-with-objects contains parameters for each level of the game.\n     * The keys in the \"outermost\" object (albacore, etc) are the names of the levels\n     *\n     * @type {{albacore: {starter: boolean, openingPopulation: number, carryingCapacity: number, winningPopulation: number, losingPopulation: number, openingBalance: number, openingTurn: number, endingTurn: number, defaultPrice: number, overhead: number, visibleProbability: number, birthProbability: number, catchProbability: number, binomialProbabilityModel: boolean, boatCapacity: number, calculatePrice: (function(*): number)}, bonito: {starter: boolean, openingPopulation: number, carryingCapacity: number, winningPopulation: number, losingPopulation: number, openingBalance: number, openingTurn: number, endingTurn: number, defaultPrice: number, overhead: number, visibleProbability: number, birthProbability: number, catchProbability: number, binomialProbabilityModel: boolean, boatCapacity: number, calculatePrice: (function(*): number)}, cod: {starter: boolean, openingPopulation: number, carryingCapacity: number, winningPopulation: number, losingPopulation: number, openingBalance: number, openingTurn: number, endingTurn: number, defaultPrice: number, overhead: number, visibleProbability: number, birthProbability: number, catchProbability: number, binomialProbabilityModel: boolean, boatCapacity: number, priceMax: number, salesMax: number, calculatePrice: (function(*): number)}, halibut: {starter: boolean, openingPopulation: number, carryingCapacity: number, winningPopulation: number, losingPopulation: number, openingBalance: number, openingTurn: number, endingTurn: number, defaultPrice: number, overhead: number, visibleProbability: number, birthProbability: number, catchProbability: number, binomialProbabilityModel: boolean, boatCapacity: number, priceMax: number, salesMax: number, calculatePrice: (function(*): number)}}}\n     */\n    fishGameParameters : {\n\n        albacore: {\n            starter : true,\n            openingPopulation: 400,\n            carryingCapacity: 3000,\n\n            winningPopulation: 800,\n            losingPopulation: 100,\n            openingBalance: 5000,\n            openingTurn: 2020,\n            endingTurn : 2060,          //          2060\n            defaultPrice: 100,\n            overhead: 2000,\n            visibleProbability: 0.50,\n            birthProbability: 0.10,\n            catchProbability : 1.00,\n            binomialProbabilityModel: false,\n            boatCapacity: 120,\n\n            calculatePrice : function(n) { return this.defaultPrice; }\n        },\n\n        bonito: {\n            starter : false,\n            openingPopulation: 400,\n            carryingCapacity: 3000,\n\n            winningPopulation: 800,\n            losingPopulation: 100,\n            openingBalance: 5000,\n            openingTurn: 2020,\n            endingTurn : 2060,\n            defaultPrice: 100,\n            overhead: 2000,\n            visibleProbability: 0.50,\n            birthProbability: 0.10,\n            catchProbability : 1.00,\n            binomialProbabilityModel: true,\n            boatCapacity: 120,\n\n            calculatePrice : function(n) { return this.defaultPrice; }\n        },\n\n        cod: {\n            starter : false,\n            openingPopulation: 400,\n            carryingCapacity: 3000,\n\n            winningPopulation: 1000,\n            losingPopulation: 100,\n            openingBalance: 3000,\n            openingTurn: 2020,\n            endingTurn : 2060,\n            defaultPrice: 100,\n            overhead: 2000,\n            visibleProbability: 0.50,\n            birthProbability: 0.10,\n            catchProbability : 1.00,\n            binomialProbabilityModel: false,\n            boatCapacity: 120,\n\n            priceMax : 80,\n            salesMax : 200,\n\n            calculatePrice : function(n) {\n                let tPrice = this.priceMax * ( 1 - n / this.salesMax);\n                if (tPrice < 0) tPrice = 0;\n                return tPrice;\n            }\n        },\n\n        halibut: {\n            starter : false,\n            openingPopulation: 400,\n            carryingCapacity: 3000,\n\n            winningPopulation: 1000,\n            losingPopulation: 100,\n            openingBalance: 3000,\n            openingTurn: 2020,\n            endingTurn : 2060,\n            defaultPrice: 100,\n            overhead: 2000,\n            visibleProbability: 0.50,\n            birthProbability: 0.10,\n            catchProbability : 0.60,\n            binomialProbabilityModel: true,\n            boatCapacity: 120,\n\n            priceMax : 80,\n            salesMax : 200,\n\n            calculatePrice : function(n) {\n                let tPrice = this.priceMax * ( 1 - n / this.salesMax);\n                if (tPrice < 0) tPrice = 0;\n                return tPrice;\n            }\n        }\n    }\n};\n\nexport default poseidon;","/*\n==========================================================================\n\n * Created by tim on 9/3/19.\n \n \n ==========================================================================\nphpHelper in poseidon\n\nAuthor:   Tim Erickson\n\nCopyright (c) 2018 by The Concord Consortium, Inc. All rights reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\nhttp://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n==========================================================================\n\n*/\n\nimport poseidon from \"./constants.js\";\n\nconst phpConnect = {\n\n    sendRequest: async function (iRequest) {\n        if (iRequest.action === \"update\") {\n            console.log(\"in sendRequest with \" + JSON.stringify(iRequest));\n        }\n\n        let theBody = new FormData();\n        // eslint-disable-next-line\n        for (const k in iRequest) {\n            if (iRequest.hasOwnProperty(k)) {\n                theBody.append(k, JSON.stringify(iRequest[k]))\n            }\n        }\n        const theRequest = new Request(\n            poseidon.constants.kBaseURL[poseidon.constants.whence],\n            {method: 'POST', body: theBody, header: new Headers()}\n        );\n\n        const theResponse = await fetch(theRequest);\n        if (theResponse.ok) {\n            try {\n                const out = await theResponse.json();\n                return out;\n            } catch (msg) {\n                console.log('fetch response decoding error : ' + msg);\n            }\n        } else {\n            alert(\"problem with database access -- icky respose\");\n        }\n    },\n\n    //  todo: consider making these NOT async...just await completion in the callers.\n    //  todo: consider getting player and turn information ONCE when we check for OK.\n\n    getGame: async function (iGame) {\n        if (iGame.gameCode) {\n            const tGameRequest = {\n                whence: poseidon.constants.whence,\n                action: \"get\",\n                resource: \"game\",\n                values: {\n                    gameCode: iGame.gameCode,\n                },\n            };\n            return await this.sendRequest(tGameRequest);\n        }\n        console.log(\"No game code to get\");\n        return false;\n    },\n\n    getPlayers: async function (iGame) {\n        if (iGame.gameCode) {\n            const tRequest = {\n                whence: poseidon.constants.whence,\n                action: \"get\",\n                resource: \"players\",\n                values: {\n                    gameCode: iGame.gameCode,\n                },\n            };\n            return await this.sendRequest(tRequest);\n        }\n        console.log(\"No game code to get, can't get players\");\n        return false;\n    },\n\n    getTurns: async function (iGame) {\n        if (iGame.gameCode && iGame.turn) {\n            const tRequest = {\n                whence: poseidon.constants.whence,\n                action: \"get\",\n                resource: \"turns\",\n                values: {\n                    gameCode: iGame.gameCode,\n                    gameTurn: iGame.turn,\n                },\n            };\n            return await this.sendRequest(tRequest);\n        }\n        console.log(\"No game code or year to get, can't get turns\");\n        return false;\n    },\n\n    makeNewGame: async function (iGameType) {\n        const params = poseidon.fishGameParameters[iGameType]\n        const tRequest = {\n            whence: poseidon.constants.whence,\n            action: \"create\",\n            resource: \"game\",\n            values: {\n                onTurn: params.openingTurn,\n                population: params.openingPopulation,\n                configuration: iGameType,\n                gameState: poseidon.constants.kInProgressString,\n            },\n        };\n        return await phpConnect.sendRequest(tRequest);\n    },\n\n    setGame: async function (iGame) {\n        const tUpdateRequest = {\n            whence: poseidon.constants.whence,\n            action: \"update\",\n            resource: \"game\",\n            values: iGame,\n        };\n        return await phpConnect.sendRequest(tUpdateRequest);\n    },\n    setTurns: async function (iTurns) {\n        const tUpdateRequest = {\n            whence: poseidon.constants.whence,\n            action: \"update\",\n            resource: \"turns\",\n            values: iTurns,\n        };\n        return await phpConnect.sendRequest(tUpdateRequest);\n    },\n    setPlayers: async function (iPlayers) {\n\n        console.log(\"setPlayers() with \" + JSON.stringify(iPlayers));\n\n        const tUpdateRequest = {\n            whence: poseidon.constants.whence,\n            action: \"update\",\n            resource: \"players\",\n            values: iPlayers,\n        };\n        return await phpConnect.sendRequest(tUpdateRequest);\n    },\n};\n\nexport default phpConnect;","/*\n==========================================================================\n\n * Created by tim on 9/17/19.\n \n \n ==========================================================================\nstrings in poseidon\n\nAuthor:   Tim Erickson\n\nCopyright (c) 2018 by The Concord Consortium, Inc. All rights reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\nhttp://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n==========================================================================\n\n*/\n\nconst strings = {\n    constructGameEndMessageFrom : function (iReason) {\n\n        let out = \"\";\n\n        if (iReason.end) {\n            let tMessageParts = [];\n\n            if (iReason.time) {\n                tMessageParts.push(\"the game ends at year \" + iReason.params.endingTurn);\n            }\n\n            switch (iReason.pop) {\n                case \"high\":\n                    tMessageParts.push(\"the total fish population is now large enough to be sustainable\");\n                    break;\n                case \"low\":\n                    tMessageParts.push(\"the total fish population is now too small to be sustainable\");\n                    break;\n                default:\n                    break;\n            }\n\n            iReason.broke.forEach((p) => {  //  broke is an array of player names.\n                tMessageParts.push(p + \" has a negative bank balance\");\n            });\n\n            if (tMessageParts.length === 0) {\n                out = \"...dang! We don't really know why!\";\n            } else {\n                out = tMessageParts.join(\", and \") + \".\";\n            }\n        }\n        return out;\n    },\n};\n\nexport default strings;","/*\n/!*\n==========================================================================\n\n * Created by tim on 9/17/19.\n \n \n ==========================================================================\nmodel in poseidon\n\nAuthor:   Tim Erickson\n\nCopyright (c) 2018 by The Concord Consortium, Inc. All rights reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\nhttp://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n==========================================================================\n\n*/\n\n//todo: bring checking the situation from php into this model.\n\nimport phpConnect from \"./poseidonPHPHelper\";\nimport poseidon from \"./constants.js\";\nimport strings from \"./strings.js\";\n\nexport default class Model extends Object  {\n\n    constructor() {\n        super();\n        this.theGame = {\n            gameCode : \"\",\n            gameType : poseidon.constants.kInitialGameTypeName,     //  called 'config' in mySQL\n            gameState : poseidon.constants.kGameWaitingString,\n        };        //  an image of the mySQL record\n        this.thePlayers = [];\n        this.theTurns = [];\n        this.gameParameters = poseidon.fishGameParameters[this.theGame.gameType];\n\n        return this;\n    }\n\n    /**\n     * Ask php to make a new game, and set the this.theGame variable.\n     *\n     * @param iGameType\n     * @returns {Promise<null>}\n     */\n    async newGame(iGameType) {\n        this.gameParameters = poseidon.fishGameParameters[iGameType];\n        this.theGame = await phpConnect.makeNewGame(iGameType);\n        this.thePlayers = [];\n        this.theTurns = [];\n\n        return this.theGame;\n    }\n\n    async refreshAllData() {\n        //  here is where these values get set.\n        this.theGame = await phpConnect.getGame(this.theGame) || {};\n        this.thePlayers = await phpConnect.getPlayers(this.theGame) || [];\n        this.theTurns = await phpConnect.getTurns(this.theGame) || [];\n\n    }\n\n    async sellFish() {\n        await this.refreshAllData();\n\n        this.updateTurnsData();  //   update the model. fast. synchronous. Sets game pop and unit price\n        this.updatePlayersData();   //  update the players balances based on their turns, unit price, etc.\n\n        const endGameObject = this.checkForEndGame();\n        //  must do side effects in checkForEndGame before setting the game, player, and turns\n\n        await phpConnect.setGame(this.theGame);\n        await phpConnect.setTurns(this.theTurns);\n        await phpConnect.setPlayers(this.thePlayers);\n\n        return endGameObject;\n    }\n\n    updateTurnsData() {\n        const tN0 = Number(this.theGame['population']);\n        const nPlayers = this.theTurns.length;\n\n        let tTotalCaughtFish = this.theTurns.reduce(function (a, v) {\n            return {caught: a.caught + Number(v.caught)}\n        }, {caught: 0});     //  count up how many fish got caught...\n\n        const tBirths = this.births();\n\n        //  update the population in model.theGame, the local copy\n        this.theGame[\"population\"] = tN0 + tBirths -\n            (nPlayers > 0 ? (tTotalCaughtFish.caught / nPlayers) : 0);\n        this.theGame['turn']++;\n\n\n        const tUnitPrice = this.gameParameters.calculatePrice(tTotalCaughtFish.caught / nPlayers);\n        console.log(\"... total caught: \" + tTotalCaughtFish.caught +\n            \", new population: \" + this.theGame[\"population\"] + \" ... Unit price is \" + tUnitPrice);\n\n        //  update all of the turns from all of the players to show ending balance\n        //  not yet uploaded to DB\n\n        this.theTurns.forEach(\n            (t) => {\n                t.unitPrice = tUnitPrice;\n                t.income = tUnitPrice * Number(t.caught);\n                t.balanceAfter = Number(t.balanceBefore) + t.income - Number(t.expenses);\n            }\n        );\n    }\n\n    /**\n     * update the player records to reflect the ending balance and the year in the corresponding turns record.\n     * The trick is to get the names right... :P\n     */\n    updatePlayersData() {\n        this.thePlayers.forEach( (p) => {\n            this.theTurns.forEach( (t) => {\n                if (t.playerName === p.playerName) {\n                    p.balance = t.balanceAfter;\n                    p.onTurn = t.onTurn + 1;\n                }\n            })\n        });\n    }\n\n    births() {\n        let tPop = this.theGame.population;\n        let tAdjustedProbability = this.gameParameters.birthProbability *\n            (1 - (tPop / this.gameParameters.carryingCapacity));\n        let tOut = tAdjustedProbability * tPop;\n\n        if (this.gameParameters.binomialProbabilityModel) {\n            tOut = 0;\n            for (let i = 0; i < tPop; i++) {\n                if (Math.random() < tAdjustedProbability) {\n                    tOut++;\n                }\n            }\n        }\n        return tOut;\n    }\n\n    checkForEndGame() {\n\n        let tReasonText = \"\";\n\n        let tEnd = \"\";      //  \"\" | \"won\" | \"lost\"\n        let tReasonObject = {\n            end: false,     //  is the game over?\n            broke: [],      //  who went broke?\n            time: false,   //  set true if time is up\n            pop: \"\",       //  high | low\n            params : this.gameParameters,\n        };\n\n        if (this.theGame.turn >= this.gameParameters.endingTurn) {\n            tReasonObject.end = true;\n            tReasonObject.time = true;\n            if (this.theGame.population > this.gameParameters.winningPopulation) {\n                tReasonObject.pop = \"high\";\n                tEnd = poseidon.constants.kWonString;\n            } else {\n                tReasonObject.pop = \"low\";\n                tEnd = poseidon.constants.kLostString;\n            }\n        }\n\n        //  check all turnes to see if anyone went negative\n        this.theTurns.forEach((t) => {\n            if (t.balanceAfter < 0) {\n                tReasonObject.end = true;\n                tReasonObject.broke.push(t.playerName);\n                tEnd = poseidon.constants.kLostString;\n            }\n        });\n\n        if (this.theGame.population < this.gameParameters.losingPopulation) {\n            tReasonObject.end = true;\n            tReasonObject.pop = \"low\";\n            tEnd = poseidon.constants.kLostString;\n        }\n\n        //  set game state appropriately to win and loss\n\n        if (tReasonObject.end) {\n            this.theGame.gameState = tEnd;      //  side effect; change the game\n            tReasonText = strings.constructGameEndMessageFrom(tReasonObject);\n        } else {\n            tReasonText = \"End of year \" + this.theGame.turn;\n        }\n\n        return {\n            reason : tReasonText,\n            end : tReasonObject.end\n        };\n    }\n\n    async getCurrentSituation() {\n\n        await this.refreshAllData();\n\n        if (this.theGame.gameCode) {\n            //  game information\n            let missingPlayers = [];\n            let allPlayers = [];\n\n            this.thePlayers.forEach((p) => {\n                let innit = false;\n                this.theTurns.forEach((t) => {\n                    if (t.playerName === p.playerName) {\n                        innit = true;\n                    }\n                });\n                allPlayers.push(p.playerName);\n                if (!innit) {\n                    missingPlayers.push(p.playerName);\n                }\n            });\n\n            const out = {\n                OK: (this.thePlayers.length === this.theTurns.length),\n                missing: missingPlayers,\n                allPlayers: allPlayers,\n            };\n\n            return out;\n        } else {\n            return {\n                OK : false,\n                missing : [],\n                allPlayers : [],\n            };\n        }\n    }\n\n};\n\n","/*\n==========================================================================\n\n * Created by tim on 9/20/19.\n \n \n ==========================================================================\nPoseidonHeader in poseidon\n\nAuthor:   Tim Erickson\n\nCopyright (c) 2018 by The Concord Consortium, Inc. All rights reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\nhttp://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n==========================================================================\n\n*/\n\nimport React from 'react';\n//  import model from \"../model\";\nimport poseidon from \"../constants\";\n\nexport default class PoseidonHeader extends React.Component {\n\n    constructor(props) {\n        console.log(\"Constructing PoseidonHeader\");\n        super(props);\n        this.state = {\n            newOrOldGame: true,\n            prospectiveGameType: poseidon.constants.kInitialGameTypeName,\n            dirty : 0,\n        };\n\n        //  binding\n        this.makeNewGame = this.makeNewGame.bind(this);\n    }\n\n    handleNewOrOldChange = (e) => {\n        this.setState({\n            newOrOldGame: (e.target.value === \"new\")\n        })\n    };\n\n    handleGameTypeChange = (e) => {\n        this.setState({prospectiveGameType: e.target.value})\n    };\n\n    async makeNewGame() {\n        const theChosenType = document.getElementById(\"gameTypesMenu\").value;\n        const newGame = await this.props.model.newGame(theChosenType);\n        console.log(\"... PoseidonHeader, new game \" + newGame.gameCode);\n        this.setDirty();\n        this.props.setDirty();\n    }\n\n    setDirty() {\n        const newDirty = this.state.dirty + 1;\n        console.log(\"... setDirty() ... \" + this.sitrep());\n        this.setState({dirty: newDirty});\n    }\n\n    sitrep() {\n        console.log(\"... PoseidonHeader, sitrep \" + this.state.dirty);\n    }\n\n    render() {\n        const theGame = this.props.model.theGame;\n\n        let wholeThing = (<div>waiting</div>);\n\n        const typesMenuGuts = Object.keys(poseidon.fishGameParameters).map(\n            (key) => (<option key={key} value={key} >{key}\n            </option>)\n        );\n\n        const gameCodeOrTypeMenu = (this.state.newOrOldGame ? (\n                <select id=\"gameTypesMenu\" value={this.state.prospectiveGameType}\n                        onChange={(e) => this.setState({prospectiveGameType: e.target.value})}>\n                    {typesMenuGuts}\n                </select>\n            ) : (\n                <input type=\"text\"></input>\n            )\n        );\n\n        const createOrJoinButton = (this.state.newOrOldGame ? (\n                <button onClick={this.makeNewGame}>new game ({this.state.prospectiveGameType})</button>\n            ) : (\n                <button> join game </button>\n            )\n        );\n\n        const radioButtons = (<div>\n            <label>\n                <input type=\"radio\" name=\"newOrOldGame\" value=\"new\" checked={this.state.newOrOldGame}\n                       onChange={this.handleNewOrOldChange}\n                /> new game\n            </label> |\n            <label>\n                <input type=\"radio\" name=\"newOrOldGame\" value=\"old\" checked={!this.state.newOrOldGame}\n                       onChange={this.handleNewOrOldChange}\n                /> old game\n            </label>\n        </div>);\n\n        if (theGame.gameState === poseidon.constants.kInProgressString) {\n            wholeThing = (<div>\n                game: {theGame.gameCode} | year: {theGame.turn} | type: {theGame.config}\n            </div>)\n        } else {\n            wholeThing = (<div>\n                {radioButtons}\n                <br/>\n                {gameCodeOrTypeMenu}{createOrJoinButton}\n            </div>)\n        }\n\n        return <div id=\"poseidonHeader\">{wholeThing}</div>;\n    }\n}\n\n","/*\n==========================================================================\n\n * Created by tim on 9/3/19.\n \n \n ==========================================================================\nposeidon in poseidon\n\nAuthor:   Tim Erickson\n\nCopyright (c) 2018 by The Concord Consortium, Inc. All rights reserved.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\nhttp://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n==========================================================================\n\n*/\n\n/*\nLocal testing: http://localhost:3000/\n */\n\nimport React from 'react';\n//  import poseidon from \"./constants.js\";\nimport Model from \"./Model.js\";\nimport PoseidonHeader from \"./components/PoseidonHeader.js\";\nimport './css/poseidon.css';\n\nimport refreshIcon from \"./art/refresh.png\";\n\nclass Poseidon extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            OKtoSell: false,\n            missing: [],\n            dirty: 0,\n            now: new Date(),\n        };\n        console.log(\"Constructing Poseidon. State: \" + JSON.stringify(this.state));\n\n        this.model = new Model();\n\n        //  bindings\n        this.setDirty = this.setDirty.bind(this);\n    }\n\n    componentDidMount() {\n        /*\n                this.timerID = setInterval(\n                    () => this.poll(),\n                    poseidon.constants.kTimerInterval\n                );\n        */\n    }\n\n    componentWillUnmount() {\n        clearInterval(this.timerID);\n    }\n\n    async poll() {\n        this.setState({now: new Date()});\n        const theSituationResponse = await this.model.getCurrentSituation();\n\n        this.setState({\n            OKtoSell: theSituationResponse.OK,\n            missing: theSituationResponse.missing,\n        });\n\n        console.log(\"... poll() ... \" + this.sitrep());\n    }\n\n    setDirty() {\n        const newDirty = this.state.dirty + 1;\n        this.setState({dirty: newDirty});\n        console.log(\"... setDirty() ... \" + this.sitrep());\n    }\n\n    sitrep() {\n        const theGame = this.model.theGame;\n\n        return \"Poseidon sitrep: \" + theGame.config + \" game \" + theGame.gameCode +\n            \" (\" + theGame.gameState + \") turn \" + theGame.turn +\n            \" dirty = \" + this.state.dirty;\n    }\n\n\n    async sellFish() {\n        console.log(\"Selling fish!\");\n        await this.model.sellFish();\n        this.setDirty();\n        console.log(\"Fish sold!\");\n    }\n\n    render() {\n        return (\n            <div id={\"poseidon\"}>\n                <h1>Poseidon: God of the Sea</h1>\n                <PoseidonHeader\n                    id={\"poseidonHeader\"}\n                    model={this.model}\n                    setDirty={this.setDirty}\n                />\n\n                <RefreshButton\n                    doRefresh={this.poll.bind(this)}\n                />\n\n                <SellButton\n                    OK={this.state.OKtoSell}\n                    sellHandler={this.sellFish.bind(this)}\n                    missingNames={this.state.missing}\n                />\n                <PlayerList\n                    thePlayers={this.model.thePlayers}\n                />\n\n                <div>{this.state.now.toLocaleTimeString()}</div>\n            </div>\n        )\n    }\n\n}\n\n/*\n\n    NOT part of the Poseidon class\n\n */\n\nfunction RefreshButton(props) {\n    async function doRefresh(e) {\n        props.doRefresh();\n    }\n\n    return (\n        <div>\n            <input id=\"refreshButton\" type=\"image\"\n                   alt=\"refresh\"\n                   height=\"14\" width=\"16\" src={refreshIcon}\n                   onClick={doRefresh}></input>\n        </div>\n    )\n\n}\n\nfunction PlayerList(props) {\n\n    const listGuts = props.thePlayers.map(\n        (p) => (<tr key={p.playerName}>\n            <td>{p.playerName}</td>\n            <td>{p.onTurn}</td>\n            <td>{p.balance}</td>\n        </tr>)\n    );\n    const headerText = props.thePlayers.length + \" player(s)\";\n    const tableHeader = (<tr>\n        <th>name</th>\n        <th>turn</th>\n        <th>balance</th>\n    </tr>);\n    const wholeThing = props.thePlayers.length > 0 ?\n        (\n            <div>\n                <h2>{headerText}</h2>\n                <div>\n                    <table id={\"playerTable\"}>\n                        <thead>{tableHeader}</thead>\n                        <tbody>{listGuts}</tbody>\n                    </table>\n                </div>\n            </div>\n        ) :\n        \"No players\"\n    return (<div>{wholeThing}</div>)\n}\n\nfunction SellButton(props) {\n    if (props.OK) {\n        return (\n            <div>\n                <button id=\"sellFishButton\" onClick={props.sellHandler}>sell fish</button>\n            </div>\n        );\n    } else {\n        if (props.missingNames.length > 0) {\n            const missingPlayerList = props.missingNames.join(\", \");\n            return (<div>Waiting for {missingPlayerList}</div>)\n        } else {\n            return (<div>No players</div>)\n        }\n    }\n}\n\nexport default Poseidon;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport Poseidon from './Poseidon';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<Poseidon />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}