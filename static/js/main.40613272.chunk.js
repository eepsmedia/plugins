(window.webpackJsonpposeidon=window.webpackJsonpposeidon||[]).push([[0],{12:function(e,t){e.exports="data:image/png;base64,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"},14:function(e,t,n){e.exports=n(22)},19:function(e,t,n){},21:function(e,t,n){},22:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(11),s=n.n(i),o=(n(19),n(1)),l=n.n(o),u=n(2),c=n(6),h=n(7),m=n(5),p=n(4),g=n(3),d=n(8),f=n(13),y={constants:{version:"001a",whence:"local",kTimerInterval:2500,kUsingTimer:!0,kInitialLanguage:"en",kInitialTurn:2020,kInitialPopulation:200,kInitialGameTypeName:"albacore",kSellingString:"selling",kFishingString:"fishing",kBetweenString:"between games",kInProgressString:"in progress",kWonString:"won",kLostString:"lost",kWaitingString:"waiting",kBaseURL:{local:"http://localhost:8888/plugins/poseidon/src/poseidon.php",xyz:"https://codap.xyz/projects/poseidon/src/poseidon.php"}},fishGameParameters:{albacore:{starter:!0,openingPopulation:400,carryingCapacity:3e3,winningPopulation:800,losingPopulation:100,openingBalance:5e3,openingTurn:2020,endingTurn:2060,defaultPrice:100,overhead:2e3,visibleProbability:.5,birthProbability:.1,catchProbability:1,binomialProbabilityModel:!1,boatCapacity:120,calculatePrice:function(e){return this.defaultPrice}},bonito:{starter:!1,openingPopulation:400,carryingCapacity:3e3,winningPopulation:800,losingPopulation:100,openingBalance:5e3,openingTurn:2020,endingTurn:2060,defaultPrice:100,overhead:2e3,visibleProbability:.5,birthProbability:.1,catchProbability:1,binomialProbabilityModel:!0,boatCapacity:120,calculatePrice:function(e){return this.defaultPrice}},cod:{starter:!1,openingPopulation:400,carryingCapacity:3e3,winningPopulation:1e3,losingPopulation:100,openingBalance:3e3,openingTurn:2020,endingTurn:2060,defaultPrice:100,overhead:2e3,visibleProbability:.5,birthProbability:.1,catchProbability:1,binomialProbabilityModel:!1,boatCapacity:120,priceMax:80,salesMax:200,calculatePrice:function(e){var t=this.priceMax*(1-e/this.salesMax);return t<0&&(t=0),t}},halibut:{starter:!1,openingPopulation:400,carryingCapacity:3e3,winningPopulation:1e3,losingPopulation:100,openingBalance:3e3,openingTurn:2020,endingTurn:2060,defaultPrice:100,overhead:2e3,visibleProbability:.5,birthProbability:.1,catchProbability:.6,binomialProbabilityModel:!0,boatCapacity:120,priceMax:80,salesMax:200,calculatePrice:function(e){var t=this.priceMax*(1-e/this.salesMax);return t<0&&(t=0),t}}}},b={sendRequest:function(){var e=Object(u.a)(l.a.mark(function e(t){var n,a,r,i,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a in t.action,n=new FormData,t)t.hasOwnProperty(a)&&n.append(a,JSON.stringify(t[a]));return r=new Request(y.constants.kBaseURL[y.constants.whence],{method:"POST",body:n,header:new Headers}),e.next=6,fetch(r);case 6:if(!(i=e.sent).ok){e.next=20;break}return e.prev=8,e.next=11,i.json();case 11:return s=e.sent,e.abrupt("return",s);case 15:e.prev=15,e.t0=e.catch(8),console.log("fetch response decoding error : "+e.t0);case 18:e.next=21;break;case 20:alert("problem with database access -- icky respose");case 21:case"end":return e.stop()}},e,null,[[8,15]])}));return function(t){return e.apply(this,arguments)}}(),getGame:function(){var e=Object(u.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.gameCode){e.next=5;break}return n={whence:y.constants.whence,action:"get",resource:"game",values:{gameCode:t.gameCode}},e.next=4,this.sendRequest(n);case 4:return e.abrupt("return",e.sent);case 5:return console.log("No game code to get"),e.abrupt("return",!1);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getPlayers:function(){var e=Object(u.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.gameCode){e.next=5;break}return n={whence:y.constants.whence,action:"get",resource:"players",values:{gameCode:t.gameCode}},e.next=4,this.sendRequest(n);case 4:return e.abrupt("return",e.sent);case 5:return console.log("No game code to get, can't get players"),e.abrupt("return",!1);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getTurns:function(){var e=Object(u.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.gameCode||!t.turn){e.next=5;break}return n={whence:y.constants.whence,action:"get",resource:"turns",values:{gameCode:t.gameCode,gameTurn:t.turn}},e.next=4,this.sendRequest(n);case 4:return e.abrupt("return",e.sent);case 5:return console.log("No game code or year to get, can't get turns"),e.abrupt("return",!1);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),makeNewGame:function(){var e=Object(u.a)(l.a.mark(function e(t){var n,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=y.fishGameParameters[t],a={whence:y.constants.whence,action:"create",resource:"game",values:{onTurn:n.openingTurn,population:n.openingPopulation,configuration:t,gameState:y.constants.kInProgressString}},e.next=4,b.sendRequest(a);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),setGame:function(){var e=Object(u.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={whence:y.constants.whence,action:"update",resource:"game",values:t},e.next=3,b.sendRequest(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),setTurns:function(){var e=Object(u.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={whence:y.constants.whence,action:"update",resource:"turns",values:t},e.next=3,b.sendRequest(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),setPlayers:function(){var e=Object(u.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("setPlayers() with "+JSON.stringify(t)),n={whence:y.constants.whence,action:"update",resource:"players",values:t},e.next=4,b.sendRequest(n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},v=b,k={constructGameEndMessageFrom:function(e){var t="";if(e.end){var n=[];switch(e.time&&n.push("the game ends at year "+e.params.endingTurn),e.pop){case"high":n.push("the total fish population is now large enough to be sustainable");break;case"low":n.push("the total fish population is now too small to be sustainable")}e.broke.forEach(function(e){n.push(e+" has a negative bank balance")}),t=0===n.length?"...dang! We don't really know why!":n.join(", and ")+"."}return t}},w=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(m.a)(this,Object(p.a)(t).call(this))).theGame={gameCode:"",gameType:y.constants.kInitialGameTypeName,gameState:y.constants.kGameWaitingString},e.thePlayers=[],e.theTurns=[],e.gameParameters=y.fishGameParameters[e.theGame.gameType],Object(m.a)(e,Object(g.a)(e))}return Object(d.a)(t,e),Object(h.a)(t,[{key:"newGame",value:function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.gameParameters=y.fishGameParameters[t],e.next=3,v.makeNewGame(t);case 3:return this.theGame=e.sent,this.thePlayers=[],this.theTurns=[],e.abrupt("return",this.theGame);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"refreshAllData",value:function(){var e=Object(u.a)(l.a.mark(function e(t){var n=arguments;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return 1===n.length&&(this.theGame={gameCode:t}),e.next=3,v.getGame(this.theGame);case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0={};case 6:if(this.theGame=e.t0,this.theGame){e.next=9;break}return e.abrupt("return",!1);case 9:return e.next=11,v.getPlayers(this.theGame);case 11:if(e.t1=e.sent,e.t1){e.next=14;break}e.t1=[];case 14:return this.thePlayers=e.t1,e.next=17,v.getTurns(this.theGame);case 17:if(e.t2=e.sent,e.t2){e.next=20;break}e.t2=[];case 20:return this.theTurns=e.t2,e.abrupt("return",!0);case 22:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"sellFish",value:function(){var e=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.refreshAllData();case 2:return this.updateTurnsData(),this.updatePlayersData(),e.next=6,v.setGame(this.theGame);case 6:return e.next=8,v.setTurns(this.theTurns);case 8:return e.next=10,v.setPlayers(this.thePlayers);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"updateTurnsData",value:function(){var e=Number(this.theGame.population),t=this.theTurns.length,n=this.theTurns.reduce(function(e,t){return{caught:e.caught+Number(t.caught)}},{caught:0}),a=this.births();this.theGame.population=e+a-(t>0?n.caught/t:0),this.theGame.turn++;var r=this.gameParameters.calculatePrice(n.caught/t);console.log("... total caught: "+n.caught+", new population: "+this.theGame.population+" ... Unit price is "+r),this.theTurns.forEach(function(e){e.unitPrice=r,e.income=r*Number(e.caught),e.balanceAfter=Number(e.balanceBefore)+e.income-Number(e.expenses)})}},{key:"updatePlayersData",value:function(){var e=this;this.thePlayers.forEach(function(t){e.theTurns.forEach(function(e){e.playerName===t.playerName&&(t.balance=e.balanceAfter,t.onTurn=e.onTurn+1)})})}},{key:"births",value:function(){var e=this.theGame.population,t=this.gameParameters.birthProbability*(1-e/this.gameParameters.carryingCapacity),n=t*e;if(this.gameParameters.binomialProbabilityModel){n=0;for(var a=0;a<e;a++)Math.random()<t&&n++}return n}},{key:"checkForEndGame",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,n,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="",n="",a={end:!1,broke:[],time:!1,pop:"",params:this.gameParameters},this.theGame.turn>=this.gameParameters.endingTurn&&(a.end=!0,a.time=!0,this.theGame.population>this.gameParameters.winningPopulation?(a.pop="high",n=y.constants.kWonString):(a.pop="low",n=y.constants.kLostString)),this.theTurns.forEach(function(e){e.balanceAfter<0&&(a.end=!0,a.broke.push(e.playerName),n=y.constants.kLostString)}),this.theGame.population<this.gameParameters.losingPopulation&&(a.end=!0,a.pop="low",n=y.constants.kLostString),a.end?(this.theGame.gameState=n,t=k.constructGameEndMessageFrom(a)):t="End of year "+this.theGame.turn,this.theGame.reason=t,e.next=10,v.setGame(this.theGame);case 10:return e.abrupt("return",this.theGame);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getCurrentSituation",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,n,a=this;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.refreshAllData();case 2:return e.next=4,this.checkForEndGame();case 4:if(!this.theGame.gameCode){e.next=15;break}if(t=[],n=[],this.thePlayers.forEach(function(e){var r=!1;a.theTurns.forEach(function(t){t.playerName===e.playerName&&(r=!0)}),n.push(e.playerName),r||t.push(e.playerName)}),this.theGame.gameState!==y.constants.kInProgressString){e.next=12;break}return e.abrupt("return",{OK:this.thePlayers.length===this.theTurns.length,missing:t,allPlayers:n,playing:!0});case 12:return e.abrupt("return",{OK:!1,missing:[],allPlayers:n,playing:!1});case 13:e.next=16;break;case 15:return e.abrupt("return",{OK:!1,missing:[],allPlayers:[],playing:!1});case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(Object(f.a)(Object)),E=function(e){function t(e){var n;return Object(c.a)(this,t),console.log("Constructing PoseidonHeader"),(n=Object(m.a)(this,Object(p.a)(t).call(this,e))).handleNewOrOldChange=function(e){n.setState({newOrOldGame:"new"===e.target.value})},n.handleGameTypeChange=function(e){n.setState({prospectiveGameType:e.target.value})},n.state={newOrOldGame:!0,prospectiveGameType:y.constants.kInitialGameTypeName,dirty:0},n.makeNewGame=n.makeNewGame.bind(Object(g.a)(n)),n.joinOldGame=n.joinOldGame.bind(Object(g.a)(n)),n}return Object(d.a)(t,e),Object(h.a)(t,[{key:"makeNewGame",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("gameTypesMenu").value,e.next=3,this.props.model.newGame(t);case 3:n=e.sent,console.log("... PoseidonHeader, new game "+n.gameCode),this.setDirty(),this.props.setDirty();case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"joinOldGame",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("oldGameCodeInput").value,e.next=3,this.props.model.refreshAllData(t);case 3:e.sent||alert("Could not find game "+t+". Please try again."),this.props.setDirty();case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setDirty",value:function(){var e=this.state.dirty+1;console.log("... setDirty() ... "+this.sitrep()),this.setState({dirty:e})}},{key:"sitrep",value:function(){console.log("... PoseidonHeader, sitrep "+this.state.dirty)}},{key:"render",value:function(){var e=this,t=this.props.model.theGame,n=r.a.createElement("div",null,"waiting"),a=Object.keys(y.fishGameParameters).map(function(e){return r.a.createElement("option",{key:e,value:e},e)}),i=this.state.newOrOldGame?r.a.createElement("select",{id:"gameTypesMenu",value:this.state.prospectiveGameType,onChange:function(t){return e.setState({prospectiveGameType:t.target.value})}},a):r.a.createElement("input",{type:"text",id:"oldGameCodeInput"}),s=this.state.newOrOldGame?r.a.createElement("button",{onClick:this.makeNewGame},"new game (",this.state.prospectiveGameType,")"):r.a.createElement("button",{onClick:this.joinOldGame},"join game"),o=r.a.createElement("div",{className:"radioButtons"},r.a.createElement("label",null,r.a.createElement("input",{type:"radio",name:"newOrOldGame",value:"new",checked:this.state.newOrOldGame,onChange:this.handleNewOrOldChange})," new game")," ",r.a.createElement("br",null),r.a.createElement("label",null,r.a.createElement("input",{type:"radio",name:"newOrOldGame",value:"old",checked:!this.state.newOrOldGame,onChange:this.handleNewOrOldChange})," old game"));return n=t.gameState===y.constants.kInProgressString?r.a.createElement("div",{id:"poseidonHeader"},r.a.createElement("strong",null,t.gameCode),"\xa0|\xa0",r.a.createElement("strong",null,t.turn),"\xa0|\xa0",r.a.createElement("span",null,r.a.createElement("strong",null,t.population))," ",r.a.createElement("span",null,"\xa0\ud83d\udc1f \xa0"),"|",r.a.createElement("span",null,"\xa0type: ",t.config)):r.a.createElement("div",{id:"poseidonHeader"},o,i,"\xa0",s),r.a.createElement("div",null,n)}}]),t}(r.a.Component),P=(n(21),n(12)),G=n.n(P);function O(e){function t(){return(t=Object(u.a)(l.a.mark(function t(n){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.doRefresh();case 1:case"end":return t.stop()}},t)}))).apply(this,arguments)}return r.a.createElement("div",null,r.a.createElement("input",{id:"refreshButton",type:"image",alt:"refresh",height:"25%",width:"25%",src:G.a,onClick:function(e){return t.apply(this,arguments)}}))}function x(e){var t=e.game;if(t.gameState===y.constants.kInProgressString)return null;var n=r.a.createElement("div",{id:"gameOverDiv"},r.a.createElement("h3",null,"Game over! The players ",t.gameState,"!"),r.a.createElement("p",null,e.reason));return r.a.createElement("div",null,n)}function S(e){var t=e.theTurns,n=e.thePlayers.map(function(e){return function(e,t){var n=null;t.forEach(function(t){t.playerName===e.playerName&&(n=t)});var a=n?n.sought:"--";return r.a.createElement("tr",{key:e.playerName},r.a.createElement("td",null,e.playerName),r.a.createElement("td",null,e.onTurn),r.a.createElement("td",null,a),r.a.createElement("td",null,e.balance))}(e,t)}),a=e.thePlayers.length+" player(s)",i=r.a.createElement("tr",null,r.a.createElement("th",null,"name"),r.a.createElement("th",null,"turn"),r.a.createElement("th",null,"sought"),r.a.createElement("th",null,"balance")),s=e.thePlayers.length>0?r.a.createElement("div",null,r.a.createElement("h3",null,a),r.a.createElement("div",null,r.a.createElement("table",{id:"playerTable"},r.a.createElement("thead",null,i),r.a.createElement("tbody",null,n)))):r.a.createElement("h4",null,"no players yet");return r.a.createElement("div",null,s)}function C(e){if(e.OK)return r.a.createElement("div",{id:"fishMarket"},r.a.createElement("h3",null,"Fish market: "),r.a.createElement("button",{id:"sellFishButton",onClick:e.sellHandler},"sell fish"),r.a.createElement(T,{autoHandler:e.autoHandler}));if(e.missingNames.length>0){var t=e.missingNames.join(", ");return r.a.createElement("div",{id:"fishMarket"},r.a.createElement("h3",null,"Fish market: "),r.a.createElement("span",null,"Waiting for ",t),r.a.createElement(T,{autoHandler:e.autoHandler}))}return r.a.createElement("div",null,"no fish to sell")}function T(e){return r.a.createElement("div",null,r.a.createElement("input",{type:"checkbox",id:"autoSellBox",onChange:e.autoHandler}),r.a.createElement("label",{htmlFor:"autoSellBox"},"automate market"))}var j=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={OKtoSell:!1,autoSell:!1,missing:[],dirty:0,now:new Date},console.log("Constructing Poseidon. State: "+JSON.stringify(n.state)),n.model=new w,n.setDirty=n.setDirty.bind(Object(g.a)(n)),n}return Object(d.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerID)}},{key:"poll",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.model.getCurrentSituation();case 2:if(t=e.sent,this.setState({OKtoSell:t.OK,missing:t.missing,now:new Date}),console.log("... poll() ... "+this.sitrep()),!(this.state.OKtoSell&&this.state.autoSell&&this.model.thePlayers.length>0&&this.playing())){e.next=9;break}return e.next=8,this.sellFish();case 8:console.log(" *** auto sold *** now it's "+this.model.theGame.turn);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setDirty",value:function(){this.poll();var e=this.state.dirty+1;this.setState({dirty:e}),console.log("... setDirty() ... "+this.sitrep())}},{key:"playing",value:function(){return this.model.theGame.gameState===y.constants.kInProgressString||this.model.theGame.gameState===y.constants.kWaitingString}},{key:"sitrep",value:function(){var e=this.model.theGame;return"Poseidon sitrep: "+e.config+" game "+e.gameCode+" ("+e.gameState+") turn "+e.turn+" dirty = "+this.state.dirty}},{key:"sellFish",value:function(){var e=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return document.getElementById("sellFishButton").style.visibility="hidden",console.log("Selling fish!"),e.next=4,this.model.sellFish();case 4:this.setDirty(),console.log("Fish sold!"),document.getElementById("sellFishButton").style.visibility="visible";case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"handleAutoSellBoxChange",value:function(e){var t=document.getElementById("autoSellBox").checked;this.setState({autoSell:t}),console.log("Auto sell checkbox now "+t),this.poll()}},{key:"render",value:function(){var e;return e=this.model.theGame.gameCode?r.a.createElement("div",{id:"gameRunningStuff"},r.a.createElement(C,{OK:this.state.OKtoSell,autoHandler:this.handleAutoSellBoxChange.bind(this),sellHandler:this.sellFish.bind(this),missingNames:this.state.missing}),r.a.createElement(x,{game:this.model.theGame,reason:this.model.theGame.reason}),r.a.createElement(S,{thePlayers:this.model.thePlayers,theTurns:this.model.theTurns})):r.a.createElement("div",{id:"gameRunningStuff"},r.a.createElement("h4",null,"no game yet")),r.a.createElement("div",{id:"poseidon"},r.a.createElement("div",{id:"titleBar"},r.a.createElement("h1",null,"Poseidon"),r.a.createElement(O,{doRefresh:this.poll.bind(this)})),r.a.createElement(E,{id:"poseidonHeader",model:this.model,setDirty:this.setDirty}),e,r.a.createElement("div",{id:"clock"},r.a.createElement("strong",null,this.state.now.toLocaleTimeString())))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[14,1,2]]]);
//# sourceMappingURL=main.40613272.chunk.js.map